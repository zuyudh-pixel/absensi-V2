{"files":[{"id":"391bc4e7-9969-4f2f-a12f-1e9e4d048306","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Jakarta\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"7f1db0b4-e856-4984-bb3f-61b2135890b3","name":"Kode","type":"server_js","source":"/*\n* ABSENSI - GOOGLE SCRIPT (Versi Visual \u0026 Validasi Jarak Rapi)\n* ***********************************************************************************\n* Code by : fahroni|ganteng (modifikasi visual)\n* License : MIT\n*/\n\n// -------------------- SET VARIABLE --------------------\nvar idGambarLogo \u003d \u00271ssHyzoR5W-7xEH1DSni9sNjfUeDL0Hew\u0027;\nvar idDataPegawai \u003d \u00271PVwSvSudtKxcFxvwJOj_hq_Tv5KH_MI8oCyAkCZFAvM\u0027;\nvar idFolderAbsensi \u003d \u00271W_r98K8wkCe6uk9nJT55FdxgTUCjdXRe\u0027;\nvar namaPerusahaan \u003d \u0027PASCASARJANA\u0027;\nvar lokasiPerusahaan \u003d [-7.863452547618916, 111.492059379797];\nvar jarakMaxWFO \u003d 0.15;\nvar jarakMaxWFH \u003d 3000;\nvar jamMasuk \u003d \u002715:00:00\u0027;\nvar jamPulang \u003d \u002721:30:00\u0027;\nvar tidakAbsen \u003d 4; \nvar timeZone \u003d \u0027GMT+07:00\u0027;\nvar timeZoneCity \u003d \u0027Asia/Jakarta\u0027;\nvar localeCode \u003d \u0027id\u0027;\n\n// -------------------- CLASS ABSENSI --------------------\nclass absensi {\n  constructor(dt) {\n    this.dt \u003d dt;\n    this.dt.idPegawai \u003d this.dt[\u0027idPegawai\u0027] ? this.dt.idPegawai.toString() : \u0027\u0027;\n    this.dt.password \u003d this.dt[\u0027password\u0027] ? this.dt.password.toString() : \u0027\u0027;\n    this.dt.kegiatan \u003d this.dt[\u0027kegiatan\u0027] ? this.dt.kegiatan.toString() : \u0027\u0027;\n    this.dt.absensi \u003d this.dt[\u0027absensi\u0027] ? this.dt.absensi.toString() : \u0027\u0027;\n    this.dt.workFrom \u003d this.dt[\u0027workFrom\u0027] ? this.dt.workFrom.toString() : \u0027\u0027;\n    this.dt.position \u003d this.dt[\u0027position\u0027] || [0,0];\n\n    this.indexUser \u003d -1;\n    let user \u003d SpreadsheetApp.openById(idDataPegawai);\n    let userSheet \u003d user.getSheetByName(\u0027Pegawai\u0027);\n    this.user \u003d userSheet.getRange(2, 1, userSheet.getRange(\"A1\").getDataRegion().getLastRow() - 1, 10).getValues();\n  }\n\n  getSpreatsheetDataAbsensi(now){\n    let spreadsheetName \u003d Utilities.formatDate(now, timeZone, \"yyyy-MM\");\n    let sheetName \u003d \u0027Absensi Pegawai\u0027;\n    let dir \u003d DriveApp.getFolderById(idFolderAbsensi);\n    let fileName \u003d dir.getFilesByName(spreadsheetName);\n    let dataAbsensi, shDataAbsensi;\n\n    if(!fileName.hasNext()){\n      dataAbsensi \u003d SpreadsheetApp.create(spreadsheetName);\n      dataAbsensi.setSpreadsheetTimeZone(timeZoneCity);\n      dataAbsensi.setSpreadsheetLocale(localeCode);\n      dataAbsensi.renameActiveSheet(sheetName);\n      DriveApp.getFileById(dataAbsensi.getId()).moveTo(dir);\n      shDataAbsensi \u003d dataAbsensi.getSheetByName(sheetName);\n      shDataAbsensi.getRange(\u0027A1:O1\u0027)\n        .setValues([[\u0027TGL\u0027,\u0027ID\u0027,\u0027NAMA\u0027,\u0027BAGIAN\u0027,\u0027JAM MASUK\u0027,\u0027POTONGAN MASUK\u0027,\u0027STATUS MASUK\u0027,\u0027JARAK MASUK\u0027,\u0027LOKASI MASUK\u0027,\u0027JAM PULANG\u0027,\u0027POTONGAN PULANG\u0027,\u0027STATUS PULANG\u0027,\u0027JARAK PULANG\u0027,\u0027LOKASI PULANG\u0027,\u0027KEGIATAN\u0027]])\n        .setHorizontalAlignment(\u0027center\u0027).setVerticalAlignment(\u0027middle\u0027).setWrap(true)\n        .setBackground(\u0027#000000\u0027).setFontColor(\u0027#FFFFFF\u0027).setFontFamily(\u0027Comfortaa\u0027);\n      shDataAbsensi.getRange(\u0027E1:I1\u0027).setBackground(\u0027#274E13\u0027);\n      shDataAbsensi.getRange(\u0027J1:N1\u0027).setBackground(\u0027#660000\u0027);\n      shDataAbsensi.setColumnWidth(9,150);\n      shDataAbsensi.setColumnWidth(14,150);\n      shDataAbsensi.setColumnWidth(15,300);\n    } else { \n      dataAbsensi \u003d SpreadsheetApp.open(fileName.next());\n      shDataAbsensi \u003d dataAbsensi.getSheetByName(sheetName);\n    }\n    return shDataAbsensi;\n  }\n\n  getUserAbsen(shDataAbsensi,dateNow){\n    let user \u003d this.user[this.indexUser];\n    let jmlDataAbsensi \u003d shDataAbsensi.getRange(\"A1\").getDataRegion().getLastRow() - 1;\n    let indexAbsensi \u003d -1;\n    if(jmlDataAbsensi\u003e0){\n      let dataAbsensi \u003d shDataAbsensi.getRange(2, 1, jmlDataAbsensi, 2).getValues();\n      for (let i\u003d0; i\u003cdataAbsensi.length;i++) {\n        let dateDataAbsensi \u003d Utilities.formatDate(dataAbsensi[i][0], timeZone, \u0027yyyy-MM-dd\u0027);\n        if(dataAbsensi[i][1]+dateDataAbsensi \u003d\u003d user[1]+dateNow) {\n          indexAbsensi \u003d i;\n          break;\n        }\n      }\n    }\n    return indexAbsensi;\n  }\n\n  potonganMasuk(now){\n    let dateNow \u003d Utilities.formatDate(now, timeZone, \u0027yyyy-MM-dd\u0027);\n    let jamMasukToday \u003d new Date(dateNow+\u0027T\u0027+jamMasuk);\n    let telat \u003d Math.ceil(Math.max(0, now.getTime()-jamMasukToday.getTime())/(1000*60*60));\n    return Math.min(telat, tidakAbsen);\n  }\n\n  potonganPulang(now){\n    let dateNow \u003d Utilities.formatDate(now, timeZone, \u0027yyyy-MM-dd\u0027);\n    let jamPulangToday \u003d new Date(dateNow+\u0027T\u0027+jamPulang);\n    let pulangAwal \u003d Math.ceil(Math.max(0, jamPulangToday.getTime()-now.getTime())/(1000*60*60));\n    return Math.min(pulangAwal, tidakAbsen);\n  }\n\n  saveAbsensi() {\n    let now \u003d new Date();\n    let dateNow \u003d Utilities.formatDate(now, timeZone, \u0027yyyy-MM-dd\u0027);\n    let timeNow \u003d Utilities.formatDate(now, timeZone, \u0027yyyy-MM-dd HH:mm:ss\u0027);\n    let shDataAbsensi \u003d this.getSpreatsheetDataAbsensi(now);\n\n    if(this.indexUser\u003c0) return {success:false,msg:\u0027User tidak ditemukan.\u0027};\n\n    let user \u003d this.user[this.indexUser];\n    let indexAbsensi \u003d this.getUserAbsen(shDataAbsensi,dateNow);\n    let ret\u003d{success:false,msg:\u0027\u0027};\n    let masuk \u003d this.dt.absensi\u003d\u003d\u0027Masuk\u0027;\n    let koordinat \u003d (this.dt.position \u0026\u0026 this.dt.position.length\u003d\u003d2) ? this.dt.position[0]+\u0027,\u0027+this.dt.position[1] : \u0027\u0027;\n    if(typeof this.distance!\u003d\u003d\u0027number\u0027) this.distance\u003d0;\n    let potMasuk\u003dthis.potonganMasuk(now);\n    let potPulang\u003dthis.potonganPulang(now);\n\n    // Highlight warna: merah jika telat/pulang cepat\n    function highlightCell(range, potongan){\n      if(potongan\u003e0) range.setBackground(\u0027#ff9999\u0027);\n      else range.setBackground(\u0027#b3ffb3\u0027); // hijau jika tepat waktu\n    }\n\n    if(indexAbsensi\u003c0){\n      shDataAbsensi.appendRow([\n        dateNow, user[1]||\u0027\u0027, user[2]||\u0027\u0027, user[3]||\u0027\u0027,\n        masuk?timeNow:\u0027\u0027, masuk?potMasuk:tidakAbsen, masuk?this.dt.workFrom||\u0027\u0027:\u0027\u0027, masuk?this.distance:\u0027\u0027, masuk?koordinat:\u0027\u0027,\n        !masuk?timeNow:\u0027\u0027, !masuk?potPulang:tidakAbsen, !masuk?this.dt.workFrom||\u0027\u0027:\u0027\u0027, !masuk?this.distance:\u0027\u0027, !masuk?koordinat:\u0027\u0027, this.dt.kegiatan||\u0027\u0027\n      ]);\n      let lastRow \u003d shDataAbsensi.getLastRow();\n      highlightCell(shDataAbsensi.getRange(lastRow,5), potMasuk);\n      highlightCell(shDataAbsensi.getRange(lastRow,10), potPulang);\n      ret.success\u003dtrue;\n      ret.msg\u003duser[2]||\u0027\u0027;\n    } else {\n      indexAbsensi+\u003d2;\n      indexAbsensi\u003dMath.max(indexAbsensi,2);\n      let absenMasukVal\u003dshDataAbsensi.getRange(indexAbsensi,5).getValue();\n      let absenPulangVal\u003dshDataAbsensi.getRange(indexAbsensi,10).getValue();\n\n      if(masuk){\n        if(absenMasukVal){\n          ret.msg\u003d\u0027Anda sudah melakukan absensi masuk jam \u0027+Utilities.formatDate(absenMasukVal,timeZone,\u0027HH:mm:ss\u0027);\n        } else {\n          shDataAbsensi.getRange(indexAbsensi,5,1,5).setValues([[timeNow,potMasuk,this.dt.workFrom||\u0027\u0027,this.distance,koordinat]]);\n          highlightCell(shDataAbsensi.getRange(indexAbsensi,5),potMasuk);\n          ret.success\u003dtrue;\n          ret.msg\u003duser[2]||\u0027\u0027;\n        }\n      } else {\n        if(absenPulangVal){\n          ret.msg\u003d\u0027Anda sudah melakukan absensi pulang jam \u0027+Utilities.formatDate(absenPulangVal,timeZone,\u0027HH:mm:ss\u0027);\n        } else {\n          shDataAbsensi.getRange(indexAbsensi,10,1,6).setValues([[timeNow,potPulang,this.dt.workFrom||\u0027\u0027,this.distance,koordinat,this.dt.kegiatan||\u0027\u0027]]);\n          highlightCell(shDataAbsensi.getRange(indexAbsensi,10),potPulang);\n          ret.success\u003dtrue;\n          ret.msg\u003duser[2]||\u0027\u0027;\n        }\n      }\n    }\n\n    shDataAbsensi.getRange(\u0027E:E\u0027).setNumberFormat(\u0027H:mm:ss\u0027);\n    shDataAbsensi.getRange(\u0027J:J\u0027).setNumberFormat(\u0027H:mm:ss\u0027);\n\n    return ret;\n  }\n\n  validUser(){\n    let id\u003dthis.user.map(r\u003d\u003er[1].toString().toUpperCase());\n    let pass\u003dthis.user.map(r\u003d\u003er[4].toString());\n    this.indexUser\u003did.indexOf(this.dt.idPegawai.toUpperCase());\n    return (this.indexUser\u003e\u003d0 \u0026\u0026 pass[this.indexUser]\u003d\u003dthis.dt.password);\n  }\n\n  validDistance(){\n    let bolehAbsenDariRumah\u003d[\u0027WFH\u0027,\u0027Ijin\u0027];\n    if(this.dt.position[0]\u003d\u003d0 \u0026\u0026 this.dt.position[1]\u003d\u003d0) return \u0027Lokasi anda tidak terekam...\u0027;\n    this.distance\u003dthis.getDistanceBetween(lokasiPerusahaan[0],lokasiPerusahaan[1],this.dt.position[0],this.dt.position[1]);\n    let mapsLink \u003d \u0027https://www.google.com/maps/dir/?api\u003d1\u0026origin\u003d\u0027+this.dt.position[0]+\u0027,\u0027+this.dt.position[1]+\u0027\u0026destination\u003d\u0027+lokasiPerusahaan[0]+\u0027,\u0027+lokasiPerusahaan[1]+\u0027\u0026travelmode\u003dwalking\u0027;\n    if(this.distance\u003ejarakMaxWFO \u0026\u0026 !bolehAbsenDariRumah.includes(this.dt.workFrom))\n      return \u0027Lokasi terlalu jauh dari kampus: \u003ca href\u003d\"\u0027+mapsLink+\u0027\" target\u003d\"_blank\"\u003e\u0027+this.distance.toFixed(2)+\u0027 km\u003c/a\u003e\u003cbr\u003eMaks jarak WFO: 80m\u0027;\n    if(this.distance\u003ejarakMaxWFH \u0026\u0026 bolehAbsenDariRumah.includes(this.dt.workFrom))\n      return \u0027Lokasi terlalu jauh dari kampus: \u003ca href\u003d\"\u0027+mapsLink+\u0027\" target\u003d\"_blank\"\u003e\u0027+this.distance.toFixed(2)+\u0027 km\u003c/a\u003e\u003cbr\u003eMaks jarak WFH: \u0027+jarakMaxWFH+\u0027 km\u0027;\n    return \u0027confirm\u0027;\n  }\n\n  getDistanceBetween(originLat,originLong,destLat,destLong){\n    let directions\u003dMaps.newDirectionFinder().setOrigin(originLat,originLong).setDestination(destLat,destLong).setMode(Maps.DirectionFinder.Mode.WALKING).getDirections();\n    if(directions.routes[0]){\n      return directions.routes[0].legs.reduce((acc,row)\u003d\u003e{acc.dist+\u003drow.distance.value/1000;acc.dur+\u003drow.duration.value/60;return acc;},{dist:0,dur:0}).dist;\n    } else return 0;\n  }\n}\n\n// -------------------- GLOBAL FUNCTIONS --------------------\nfunction doGet(e){ return ContentService.createTextOutput(\"Backend Absensi Aktif\").setMimeType(ContentService.MimeType.TEXT); }\n\nfunction doPost(e){\n  let dt;\n  try{ dt\u003dJSON.parse(e.postData.contents); } catch(err){ return ContentService.createTextOutput(JSON.stringify({success:false,msg:\"Invalid JSON\"})).setMimeType(ContentService.MimeType.JSON);}\n  let ret\u003dsubmitAbsensi(dt);\n  return ContentService.createTextOutput(JSON.stringify(ret)).setMimeType(ContentService.MimeType.JSON);\n}\n\nfunction submitAbsensi(dt){\n  let a\u003dnew absensi(dt);\n  let ret\u003d{success:false,msg:\u0027\u0027};\n  if(!a.validUser()) ret.msg\u003d\u0027Anda tidak terdaftar/barcode tidak cocok.\u0027;\n  else{\n    let cekJarak\u003da.validDistance();\n    if(cekJarak!\u003d\u0027confirm\u0027) ret.msg\u003dcekJarak;\n    else ret\u003da.saveAbsensi();\n  }\n  return ret;\n}\n\nfunction showIndex(){\n  return templateIndex.evaluate().setSandboxMode(HtmlService.SandboxMode.IFRAME).addMetaTag(\u0027viewport\u0027,\u0027width\u003ddevice-width, initial-scale\u003d1\u0027).setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);\n}\n\nfunction getImage(fileId){\n  let img\u003dDriveApp.getFileById(fileId).getBlob().getBytes();\n  return Utilities.base64Encode(img);\n}\n\nfunction testInput(){\n  let dt\u003d{idPegawai:\u002720210001MT\u0027, password:\u002720210001\u0027, kegiatan:\u0027test\u0027, absensi:\u0027Masuk\u0027, workFrom:\u0027WFH\u0027, position:[-6.089501,106.997263]};\n  let a\u003dnew absensi(dt);\n  if(!a.validUser()) Logger.log(\u0027Anda tidak terdaftar\u0027);\n  else{\n    let cekJarak\u003da.validDistance();\n    if(cekJarak!\u003d\u0027confirm\u0027) Logger.log(cekJarak);\n    else Logger.log(a.saveAbsensi());\n  }\n}\n"},{"id":"1c6da4ae-6533-4ae5-8a10-2484ec2ce60c","name":"index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml lang\u003d\"id\"\u003e\n\u003chead\u003e\n\u003cmeta charset\u003d\"UTF-8\"\u003e\n\u003cmeta name\u003d\"viewport\" content\u003d\"width\u003ddevice-width, initial-scale\u003d1, maximum-scale\u003d1, user-scalable\u003dno\"\u003e\n\u003ctitle\u003eAbsensi Mobile\u003c/title\u003e\n\n\u003clink href\u003d\"https://fonts.googleapis.com/css2?family\u003dInter:wght@400;500;600\u0026display\u003dswap\" rel\u003d\"stylesheet\"\u003e\n\u003clink rel\u003d\"stylesheet\" href\u003d\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css\"/\u003e\n\u003cscript src\u003d\"https://unpkg.com/html5-qrcode\"\u003e\u003c/script\u003e\n\u003cscript src\u003d\"https://cdn.jsdelivr.net/npm/sweetalert2@11\"\u003e\u003c/script\u003e\n\n\u003cstyle\u003e\n:root {\n--primary: #4e73df;\n--secondary: #1cc88a;\n--glass-bg: rgba(255,255,255,0.15);\n--border: rgba(255,255,255,0.3);\n--text: #ffffff;\n}\n\nbody {\nmargin: 0;\nheight: 100vh;\nwidth: 100vw;\nbackground: linear-gradient(135deg, var(--primary), var(--secondary));\ndisplay: flex;\njustify-content: center;\nalign-items: center;\nfont-family: \u0027Inter\u0027, sans-serif;\ncolor: var(--text);\noverflow: hidden;\n}\n\n.card {\nwidth: 100%;\nmax-width: 400px;\npadding: 18px;\nbackground: var(--glass-bg);\nbackdrop-filter: blur(20px);\nborder-radius: 15px;\noverflow-y: auto;\n}\n\n.header { text-align:center; margin-bottom:10px; }\n.logo { width: 50px; margin:12px 0 5px; }\n.title { font-size:14px; }\n.subtitle { font-size:14px; font-weight:700; margin-top:8px; }\n\n#reader { width:100%; border-radius:15px; margin:12px 0; }\n\n.option-group { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px; }\n.option-group label { flex:1; text-align:center; padding:10px; border-radius:14px; background:rgba(255,255,255,0.1); cursor:pointer; transition:0.3s; font-weight:600; }\n.option-group label:hover { transform:translateY(-3px); background:rgba(255,255,255,0.25); }\n.option-group input { display:none; }\n.option-group input:checked + span { background:white; color:#333; border-radius:14px; display:inline-block; width:100%; }\n\ntextarea { width:100%; min-height:35px; padding:10px; border-radius:15px; border:none; outline:none; resize:none; font-size:13px; margin-bottom:10px; }\n\nbutton { width:100%; padding:10px; border:none; border-radius:15px; background:white; color:#333; font-weight:600; cursor:pointer; transition:0.3s; }\nbutton.btn-loading { position:relative; pointer-events:none; opacity:0.8; }\nbutton.btn-loading::after { content:\"\"; width:18px; height:18px; border:3px solid #ccc; border-top:3px solid #333; border-radius:50%; position:absolute; right:15px; top:50%; transform:translateY(-50%); animation:spin 0.7s linear infinite; }\n@keyframes spin { 100%{transform:translateY(-50%) rotate(360deg);} }\n\n.footer { text-align:center; font-size:10px; margin-top:20px; opacity:0.7; }\n.refresh { text-align:center; margin-top:12px; }\n.refresh a { color:white; text-decoration:none; font-size:14px; font-weight:700; }\n\n\u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cdiv class\u003d\"card\"\u003e\n\n\u003cdiv class\u003d\"header\"\u003e\n\u003cimg src\u003d\"ICON_192.png\" class\u003d\"logo\"\u003e\n\u003cdiv class\u003d\"title\"\u003ePASCASARJANA\u003c/div\u003e\n\u003cdiv class\u003d\"subtitle\"\u003eAbsensi Dosen Pengampu\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv id\u003d\"reader\"\u003e\u003c/div\u003e\n\n\u003cform id\u003d\"formAbsensi\" onsubmit\u003d\"submitAbsensi(); return false;\"\u003e\n\u003cinput type\u003d\"hidden\" id\u003d\"idPegawai\"\u003e\n\u003cinput type\u003d\"hidden\" id\u003d\"password\"\u003e\n\n\u003cdiv class\u003d\"section\"\u003eJenis Absensi\u003c/div\u003e\n\u003cdiv class\u003d\"option-group\"\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"absensi\" value\u003d\"Masuk\" required\u003e\u003cspan\u003eMasuk\u003c/span\u003e\u003c/label\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"absensi\" value\u003d\"Pulang\"\u003e\u003cspan\u003ePulang\u003c/span\u003e\u003c/label\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"absensi\" value\u003d\"Ijin\"\u003e\u003cspan\u003eIjin\u003c/span\u003e\u003c/label\u003e\n\u003c/div\u003e\n\n\u003cdiv class\u003d\"section\"\u003eLokasi\u003c/div\u003e\n\u003cdiv class\u003d\"option-group\"\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"workFrom\" value\u003d\"WFO\" required\u003e\u003cspan\u003eKampus\u003c/span\u003e\u003c/label\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"workFrom\" value\u003d\"WFH\"\u003e\u003cspan\u003eWFA\u003c/span\u003e\u003c/label\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"workFrom\" value\u003d\"Ijin\"\u003e\u003cspan\u003eIjin\u003c/span\u003e\u003c/label\u003e\n\u003c/div\u003e\n\n\u003cdiv class\u003d\"section\"\u003eKelas/Keterangan\u003c/div\u003e\n\u003ctextarea id\u003d\"kegiatan\" placeholder\u003d\"Isikan nama kelas atau keterangan\"\u003e\u003c/textarea\u003e\n\n\u003cbutton type\u003d\"submit\" id\u003d\"btnSubmit\"\u003e\u003ci class\u003d\"fas fa-fingerprint\"\u003e\u003c/i\u003e Kirim Absensi\u003c/button\u003e\n\u003c/form\u003e\n\n\u003cdiv class\u003d\"refresh\"\u003e\n\u003ca href\u003d\"#\" onclick\u003d\"resetFormApp()\"\u003e\u003ci class\u003d\"fas fa-sync-alt\"\u003e\u003c/i\u003e Absensi Lagi | Reset\u003c/a\u003e\n\u003c/div\u003e\n\n\u003cdiv class\u003d\"footer\"\u003e\n© \u003cspan id\u003d\"tahun\"\u003e\u003c/span\u003e PASCASARJANA\n\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cscript src\u003d\"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js\"\u003e\u003c/script\u003e\n\n\u003cscript\u003e\n// Token keamanan untuk API\nconst API_TOKEN \u003d \"SECRET_TOKEN_123456\"; // harus sama dengan backend\nconst API_URL \u003d \"PASTE_URL_API_GOOGLE_SCRIPT\"; // ganti URL Web App\n\n// QR Code Scanner\nfunction onScanSuccess(decodedText) {\n  const data \u003d decodedText.split(\"|\");\n  if(data.length\u003d\u003d\u003d2){\n    $(\"#idPegawai\").val(data[0]);\n    $(\"#password\").val(data[1]);\n    Swal.fire({icon:\"success\", title:\"Scan Berhasil\", text:\"ID: \"+data[0], timer:1500, showConfirmButton:false});\n    html5QrcodeScanner.clear();\n  } else {\n    Swal.fire(\"Barcode tidak dikenal\",\"\",\"error\");\n  }\n}\n\nlet html5QrcodeScanner \u003d new Html5QrcodeScanner(\"reader\",{fps:10, qrbox:150});\nhtml5QrcodeScanner.render(onScanSuccess);\n\n// Submit absensi\nfunction submitAbsensi(){\n  const idPegawai \u003d $(\"#idPegawai\").val();\n  const password \u003d $(\"#password\").val();\n  const absensi \u003d $(\"input[name\u003dabsensi]:checked\").val();\n  const workFrom \u003d $(\"input[name\u003dworkFrom]:checked\").val();\n  const kegiatan \u003d $(\"#kegiatan\").val();\n\n  if(!idPegawai || !password || !absensi || !workFrom){\n    Swal.fire(\"Lengkapi data absensi dan lokasi\",\"\",\"warning\");\n    return;\n  }\n\n  startLoading();\n\n  if(!navigator.geolocation){\n    stopLoading();\n    Swal.fire(\"Browser tidak mendukung GPS\",\"\",\"error\");\n    return;\n  }\n\n  navigator.geolocation.getCurrentPosition(function(position){\n    const data \u003d {\n      token: API_TOKEN,\n      idPegawai, password, absensi, workFrom, kegiatan,\n      position: [position.coords.latitude, position.coords.longitude]\n    };\n\n    fetch(API_URL, {\n      method:\"POST\",\n      headers: {\"Content-Type\":\"application/json\"},\n      body: JSON.stringify(data)\n    })\n    .then(res \u003d\u003e res.json())\n    .then(dt \u003d\u003e {\n      stopLoading();\n      if(dt.success){\n        Swal.fire({icon:\"success\", title:\"Absensi Berhasil ✅\", html:`\u003cdiv\u003e${dt.msg}\u003c/div\u003e`, timer:2000, showConfirmButton:false})\n        .then(()\u003d\u003e resetFormApp());\n      } else {\n        Swal.fire({icon:\"error\", title:\"Gagal ❌\", html:`\u003cdiv\u003e${dt.msg}\u003c/div\u003e`});\n      }\n    })\n    .catch(err\u003d\u003e{\n      stopLoading();\n      Swal.fire(\"Terjadi kesalahan server\",\"\",\"error\");\n    });\n\n  },{\n    enableHighAccuracy:true,\n    timeout:5000\n  });\n}\n\n// Loading smooth\nfunction startLoading(){ $(\"#btnSubmit\").addClass(\"btn-loading\").html(\u0027\u003ci class\u003d\"fas fa-spinner fa-spin\"\u003e\u003c/i\u003e Memproses...\u0027); }\nfunction stopLoading(){ $(\"#btnSubmit\").removeClass(\"btn-loading\").html(\u0027\u003ci class\u003d\"fas fa-fingerprint\"\u003e\u003c/i\u003e Kirim Absensi\u0027); }\n\n// Reset form\nfunction resetFormApp(){\n  $(\"#idPegawai,#password,#kegiatan\").val(\"\");\n  $(\"input[type\u003dradio]\").prop(\"checked\", false);\n  if(html5QrcodeScanner){\n    html5QrcodeScanner.clear().then(()\u003d\u003e{\n      document.getElementById(\"reader\").innerHTML\u003d\"\";\n      html5QrcodeScanner \u003d new Html5QrcodeScanner(\"reader\",{fps:10, qrbox:150});\n      html5QrcodeScanner.render(onScanSuccess);\n    });\n  }\n}\n\n// Tahun footer\ndocument.getElementById(\"tahun\").textContent \u003d new Date().getFullYear();\n\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},{"id":"a094e8be-dda7-4c0c-8df5-1f4fa3574bad","name":"Salinan index_github","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml lang\u003d\"id\"\u003e\n\u003chead\u003e\n\u003cmeta charset\u003d\"UTF-8\"\u003e\n\u003cmeta name\u003d\"viewport\" content\u003d\"width\u003ddevice-width, initial-scale\u003d1, maximum-scale\u003d1, user-scalable\u003dno\"\u003e\n\u003ctitle\u003eAbsensi Mobile\u003c/title\u003e\n\n\u003clink href\u003d\"https://fonts.googleapis.com/css2?family\u003dInter:wght@400;500;600\u0026display\u003dswap\" rel\u003d\"stylesheet\"\u003e\n\u003clink rel\u003d\"stylesheet\" href\u003d\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css\"/\u003e\n\u003cscript src\u003d\"https://unpkg.com/html5-qrcode\"\u003e\u003c/script\u003e\n\u003cscript src\u003d\"https://cdn.jsdelivr.net/npm/sweetalert2@11\"\u003e\u003c/script\u003e\n\n\u003cstyle\u003e\n:root {\n--primary: #4e73df;\n--secondary: #1cc88a;\n--glass-bg: rgba(255,255,255,0.15);\n--border: rgba(255,255,255,0.3);\n--text: #ffffff;\n}\n\nbody {\nmargin: 0;\nheight: 100vh;\nwidth: 100vw;\nbackground: linear-gradient(135deg, var(--primary), var(--secondary));\ndisplay: flex;\njustify-content: center;\nalign-items: center;\nfont-family: \u0027Inter\u0027, sans-serif;\ncolor: var(--text);\noverflow: hidden;\n}\n\n.card {\nwidth: 100%;\nmax-width: 400px;\npadding: 18px;\nbackground: var(--glass-bg);\nbackdrop-filter: blur(20px);\nborder-radius: 15px;\noverflow-y: auto;\n}\n\n.header { text-align:center; margin-bottom:10px; }\n.logo { width: 50px; margin:12px 0 5px; }\n.title { font-size:14px; }\n.subtitle { font-size:14px; font-weight:700; margin-top:8px; }\n\n#reader { width:100%; border-radius:15px; margin:12px 0; }\n\n.option-group { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px; }\n.option-group label { flex:1; text-align:center; padding:10px; border-radius:14px; background:rgba(255,255,255,0.1); cursor:pointer; transition:0.3s; font-weight:600; }\n.option-group label:hover { transform:translateY(-3px); background:rgba(255,255,255,0.25); }\n.option-group input { display:none; }\n.option-group input:checked + span { background:white; color:#333; border-radius:14px; display:inline-block; width:100%; }\n\ntextarea { width:100%; min-height:35px; padding:10px; border-radius:15px; border:none; outline:none; resize:none; font-size:13px; margin-bottom:10px; }\n\nbutton { width:100%; padding:10px; border:none; border-radius:15px; background:white; color:#333; font-weight:600; cursor:pointer; transition:0.3s; }\nbutton.btn-loading { position:relative; pointer-events:none; opacity:0.8; }\nbutton.btn-loading::after { content:\"\"; width:18px; height:18px; border:3px solid #ccc; border-top:3px solid #333; border-radius:50%; position:absolute; right:15px; top:50%; transform:translateY(-50%); animation:spin 0.7s linear infinite; }\n@keyframes spin { 100%{transform:translateY(-50%) rotate(360deg);} }\n\n.footer { text-align:center; font-size:10px; margin-top:20px; opacity:0.7; }\n.refresh { text-align:center; margin-top:12px; }\n.refresh a { color:white; text-decoration:none; font-size:14px; font-weight:700; }\n\n\u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cdiv class\u003d\"card\"\u003e\n\n\u003cdiv class\u003d\"header\"\u003e\n\u003cimg src\u003d\"ICON_192.png\" class\u003d\"logo\"\u003e\n\u003cdiv class\u003d\"title\"\u003ePASCASARJANA\u003c/div\u003e\n\u003cdiv class\u003d\"subtitle\"\u003eAbsensi Dosen Pengampu\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv id\u003d\"reader\"\u003e\u003c/div\u003e\n\n\u003cform id\u003d\"formAbsensi\" onsubmit\u003d\"submitAbsensi(); return false;\"\u003e\n\u003cinput type\u003d\"hidden\" id\u003d\"idPegawai\"\u003e\n\u003cinput type\u003d\"hidden\" id\u003d\"password\"\u003e\n\n\u003cdiv class\u003d\"section\"\u003eJenis Absensi\u003c/div\u003e\n\u003cdiv class\u003d\"option-group\"\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"absensi\" value\u003d\"Masuk\" required\u003e\u003cspan\u003eMasuk\u003c/span\u003e\u003c/label\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"absensi\" value\u003d\"Pulang\"\u003e\u003cspan\u003ePulang\u003c/span\u003e\u003c/label\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"absensi\" value\u003d\"Ijin\"\u003e\u003cspan\u003eIjin\u003c/span\u003e\u003c/label\u003e\n\u003c/div\u003e\n\n\u003cdiv class\u003d\"section\"\u003eLokasi\u003c/div\u003e\n\u003cdiv class\u003d\"option-group\"\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"workFrom\" value\u003d\"WFO\" required\u003e\u003cspan\u003eKampus\u003c/span\u003e\u003c/label\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"workFrom\" value\u003d\"WFH\"\u003e\u003cspan\u003eWFA\u003c/span\u003e\u003c/label\u003e\n\u003clabel\u003e\u003cinput type\u003d\"radio\" name\u003d\"workFrom\" value\u003d\"Ijin\"\u003e\u003cspan\u003eIjin\u003c/span\u003e\u003c/label\u003e\n\u003c/div\u003e\n\n\u003cdiv class\u003d\"section\"\u003eKelas/Keterangan\u003c/div\u003e\n\u003ctextarea id\u003d\"kegiatan\" placeholder\u003d\"Isikan nama kelas atau keterangan\"\u003e\u003c/textarea\u003e\n\n\u003cbutton type\u003d\"submit\" id\u003d\"btnSubmit\"\u003e\u003ci class\u003d\"fas fa-fingerprint\"\u003e\u003c/i\u003e Kirim Absensi\u003c/button\u003e\n\u003c/form\u003e\n\n\u003cdiv class\u003d\"refresh\"\u003e\n\u003ca href\u003d\"#\" onclick\u003d\"resetFormApp()\"\u003e\u003ci class\u003d\"fas fa-sync-alt\"\u003e\u003c/i\u003e Absensi Lagi | Reset\u003c/a\u003e\n\u003c/div\u003e\n\n\u003cdiv class\u003d\"footer\"\u003e\n© \u003cspan id\u003d\"tahun\"\u003e\u003c/span\u003e PASCASARJANA\n\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cscript src\u003d\"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js\"\u003e\u003c/script\u003e\n\n\u003cscript\u003e\n// Token keamanan untuk API\nconst API_TOKEN \u003d \"SECRET_TOKEN_123456\"; // harus sama dengan backend\nconst API_URL \u003d \"PASTE_URL_API_GOOGLE_SCRIPT\"; // ganti URL Web App\n\n// QR Code Scanner\nfunction onScanSuccess(decodedText) {\n  const data \u003d decodedText.split(\"|\");\n  if(data.length\u003d\u003d\u003d2){\n    $(\"#idPegawai\").val(data[0]);\n    $(\"#password\").val(data[1]);\n    Swal.fire({icon:\"success\", title:\"Scan Berhasil\", text:\"ID: \"+data[0], timer:1500, showConfirmButton:false});\n    html5QrcodeScanner.clear();\n  } else {\n    Swal.fire(\"Barcode tidak dikenal\",\"\",\"error\");\n  }\n}\n\nlet html5QrcodeScanner \u003d new Html5QrcodeScanner(\"reader\",{fps:10, qrbox:150});\nhtml5QrcodeScanner.render(onScanSuccess);\n\n// Submit absensi\nfunction submitAbsensi(){\n  const idPegawai \u003d $(\"#idPegawai\").val();\n  const password \u003d $(\"#password\").val();\n  const absensi \u003d $(\"input[name\u003dabsensi]:checked\").val();\n  const workFrom \u003d $(\"input[name\u003dworkFrom]:checked\").val();\n  const kegiatan \u003d $(\"#kegiatan\").val();\n\n  if(!idPegawai || !password || !absensi || !workFrom){\n    Swal.fire(\"Lengkapi data absensi dan lokasi\",\"\",\"warning\");\n    return;\n  }\n\n  startLoading();\n\n  if(!navigator.geolocation){\n    stopLoading();\n    Swal.fire(\"Browser tidak mendukung GPS\",\"\",\"error\");\n    return;\n  }\n\n  navigator.geolocation.getCurrentPosition(function(position){\n    const data \u003d {\n      token: API_TOKEN,\n      idPegawai, password, absensi, workFrom, kegiatan,\n      position: [position.coords.latitude, position.coords.longitude]\n    };\n\n    fetch(API_URL, {\n      method:\"POST\",\n      headers: {\"Content-Type\":\"application/json\"},\n      body: JSON.stringify(data)\n    })\n    .then(res \u003d\u003e res.json())\n    .then(dt \u003d\u003e {\n      stopLoading();\n      if(dt.success){\n        Swal.fire({icon:\"success\", title:\"Absensi Berhasil ✅\", html:`\u003cdiv\u003e${dt.msg}\u003c/div\u003e`, timer:2000, showConfirmButton:false})\n        .then(()\u003d\u003e resetFormApp());\n      } else {\n        Swal.fire({icon:\"error\", title:\"Gagal ❌\", html:`\u003cdiv\u003e${dt.msg}\u003c/div\u003e`});\n      }\n    })\n    .catch(err\u003d\u003e{\n      stopLoading();\n      Swal.fire(\"Terjadi kesalahan server\",\"\",\"error\");\n    });\n\n  },{\n    enableHighAccuracy:true,\n    timeout:5000\n  });\n}\n\n// Loading smooth\nfunction startLoading(){ $(\"#btnSubmit\").addClass(\"btn-loading\").html(\u0027\u003ci class\u003d\"fas fa-spinner fa-spin\"\u003e\u003c/i\u003e Memproses...\u0027); }\nfunction stopLoading(){ $(\"#btnSubmit\").removeClass(\"btn-loading\").html(\u0027\u003ci class\u003d\"fas fa-fingerprint\"\u003e\u003c/i\u003e Kirim Absensi\u0027); }\n\n// Reset form\nfunction resetFormApp(){\n  $(\"#idPegawai,#password,#kegiatan\").val(\"\");\n  $(\"input[type\u003dradio]\").prop(\"checked\", false);\n  if(html5QrcodeScanner){\n    html5QrcodeScanner.clear().then(()\u003d\u003e{\n      document.getElementById(\"reader\").innerHTML\u003d\"\";\n      html5QrcodeScanner \u003d new Html5QrcodeScanner(\"reader\",{fps:10, qrbox:150});\n      html5QrcodeScanner.render(onScanSuccess);\n    });\n  }\n}\n\n// Tahun footer\ndocument.getElementById(\"tahun\").textContent \u003d new Date().getFullYear();\n\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"}]}